<!DOCTYPE html>
<html lang="en">
<head>
	<title>Tabs with animated underline</title>
    <meta name="author" content="Jyri Konttinen">
<style>

	* {
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        font-weight: 400;
        color: white;
		margin: 0;
		padding: 0;
		box-sizing: border-box;
	}

    body {
        font-size: 16px;
        background-color: black;
    }
	
    .tabSystem1, .tabSystem2, .tabSystem3 {
        margin: 3rem 3rem 0 3rem;
    }
    .tabContainer {
        display: flex;
    }

    .tab {
        font-size: 1rem;
        padding: 1rem;
        color: grey;
        transition: color 0.2s;
    }

    .tabSystem1 .tab:hover {
        color: white;
    }

    .tab:hover {
        cursor: pointer;
    }

    .tab.active {
        color: white;
    }

    .tabUnderline {
        background-color: salmon;
        height: 2px;
        transition: 0.5s;

    }

</style>
</head>
<body>
    <div class="tabSystem1">
        <div class="tabContainer">
            <div class="tab active" onclick="selectTab(this)">Finale&nbsp;Ligure</div>
            <div class="tab" onclick="selectTab(this)">Alpujarras</div>
            <div class="tab" onclick="selectTab(this)">Jamnica</div>
            <div class="tab" onclick="selectTab(this)">Petzen</div>
            <div class="tab" onclick="selectTab(this)">Levi</div>
        </div>
        <div class="tabUnderline"></div>
    </div>
    <div class="tabSystem2">
        <div class="tabContainer" onmouseout="returnUnderlineUnderActiveTab(this)">
            <div class="tab active" onmouseover="positionUnderline(this)" onclick="selectTab(this)">Keimiötunturi</div>
            <div class="tab" onmouseover="positionUnderline(this)" onclick="selectTab(this)">Riksgränsen</div>
            <div class="tab" onmouseover="positionUnderline(this)" onclick="selectTab(this)">Fieberbrunn</div>
            <div class="tab" onmouseover="positionUnderline(this)" onclick="selectTab(this)">Zillertal</div>
            <div class="tab" onmouseover="positionUnderline(this)" onclick="selectTab(this)">Pallas</div>
        </div>
        <div class="tabUnderline"></div>
    </div>
    <div class="tabSystem3">
        <div class="tabContainer" onmouseout="returnUnderlineUnderActiveTab(this)">
            <div class="tab active" onmouseover="extendUnderline(this)" onclick="selectTab(this)">Tukholma</div>
            <div class="tab" onmouseover="extendUnderline(this)" onclick="selectTab(this)">Berliini</div>
            <div class="tab" onmouseover="extendUnderline(this)" onclick="selectTab(this)">Espoo</div>
            <div class="tab" onmouseover="extendUnderline(this)" onclick="selectTab(this)">Bodom</div>
            <div class="tab" onmouseover="extendUnderline(this)" onclick="selectTab(this)">Salo</div>
        </div>
        <div class="tabUnderline"></div>
    </div>  
</body>
<script>


function getAllTabs(tab) {
    let tabContainer = tab.parentNode;
    return tabContainer.getElementsByClassName("tab");
}

function getUnderline(tab) {
    let tabSystem = tab.parentNode.parentNode;
    let underline = tabSystem.getElementsByClassName("tabUnderline");
    return underline[0];
}

function countWidthOfPreviousTabs(tab) {
    let widthOfPreviousTabs = 0;
    for (let i of getAllTabs(tab)) {
        if (i == tab) { return widthOfPreviousTabs }
        widthOfPreviousTabs += i.offsetWidth;
    }
}

function positionUnderline(tab) {
    getUnderline(tab).style.width = tab.offsetWidth + "px";
    getUnderline(tab).style.marginLeft = countWidthOfPreviousTabs(tab) + "px";
}

function selectTab(tab) {
    for (let i of getAllTabs(tab)) {
        i.className = i.className.replace(" active", "");
    }
    tab.className += " active";
    positionUnderline(tab);
}

function returnUnderlineUnderActiveTab(tabContainer) {
    let activeTab = tabContainer.getElementsByClassName("tab active");
    positionUnderline(activeTab[0]);
}

function extendUnderline(tab) {
    let allTabs = getAllTabs(tab);
    for (let i = 0; i < allTabs.length; i++) {
        if (tab == allTabs[i]) {
            var hoveredTabNumber = i.valueOf();
        }
        if (allTabs[i].className == "tab active") {
            var activeTabNumber = i.valueOf();
        }
    }
    let widthOfUnderline = 0;
    if (hoveredTabNumber < activeTabNumber) {
        for (let i = hoveredTabNumber; i <= activeTabNumber; i++) {
            widthOfUnderline += allTabs[i].offsetWidth;
        }
        getUnderline(tab).style.marginLeft = countWidthOfPreviousTabs(tab) + "px";
    } else {
        for (let i = activeTabNumber; i <= hoveredTabNumber; i++) {
            widthOfUnderline += allTabs[i].offsetWidth;
        }
    }
    getUnderline(tab).style.width = widthOfUnderline + "px";
}

let allActiveTabs = document.getElementsByClassName("tab active");
for (let k of allActiveTabs) {
    positionUnderline(k);
}


</script>
</html>